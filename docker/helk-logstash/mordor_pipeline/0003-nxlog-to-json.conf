# HELK nxlog to json filter
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron) Roberto Rodriguez (@Cyb3rWard0g)
# License: GPL-3.0

filter {
  if [type] == "nxlog-mordor" {
    json {
      source => "message"
      tag_on_failure => [ "_jsonparsefailure", "_parsefailure", "_jsonparsefailure_0301" ]
      #remove_field => [ "message", "type" ]
      add_field => { "z_logstash_pipeline" => "json-0003-001" }
    }
  }
}