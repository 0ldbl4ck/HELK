# HELK User Agent enrichments and additions
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {

  if [user_agent_original] {
    ruby {
      code => '
        ua = event.get("user_agent_original")
        event.set("meta_user_agent_length", ua.length)
      '
      tag_on_exception => "_rubyexception-user_agent-length"
    }
    #TODO: finish in both here and OSSEM
    #useragent {
    #  source => "user_agent_original"
    #  target => "user_agent"
    #  # Add field if successful for checking later
    #  add_field => { "[@metadata][ua_parse]" => "true" }
    #}
  }

}