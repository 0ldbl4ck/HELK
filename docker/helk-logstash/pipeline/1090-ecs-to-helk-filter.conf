# HELK ecs-to-helk filter conf
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {
    # Network common fields
    if [source] or [destination] or [network] {
      mutate {
        rename => {
          "[destination][ip]" => "dst_ip_addr"
          "[destination][port]" => "dst_port"
          "[network][application]" => "network_application_name"
          "[network][community_id]" => "fingerprint_network_community_id"
          "[network][protocol]" => "network_application_protocol"
          "[network][transport]" => "network_protocol"
          "[source][ip]" => "src_ip_addr"
          "[source][port]" => "src_port"
        }
        add_field => { "event_etl_pipeline" => "ecs_common_network_fields_rename_to_helk" }
    }
  }
}