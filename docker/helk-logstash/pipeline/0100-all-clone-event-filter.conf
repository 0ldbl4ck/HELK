# HELK All clone event conf
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {

  ## Only clone events that have been previously hashed
  if [@metadata][log_hash] and [@metadata][helk_input_source] != "mitre_attack" {
    clone {
      clones => [ "clone" ]
      remove_field =>  [
        "z_logstash_type",
        "[agent][type]"
      ]
      add_field => { "[@metadata][helk_parsed]" => "no" }
    }
  }

}
