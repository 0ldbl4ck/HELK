# HELK All filter conf file
# HELK build Stage: Alpha
# Author: Roberto Rodriguez (@Cyb3rWard0g), Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {
  if [message] {
    mutate {
      add_field => {
          "event_original_time" => "%{@timestamp}"
          "etl_pipeline" => "all-filter-0098"
          "etl_version" => "2020.04.19.01"
      }
      copy => {
          "message" => "event_original_message"
          "type" => "z_logstash_type"
      }
    }
    ruby {
      code => "event.set('etl_processed_time', Time.now());"
      add_field => { "etl_pipeline" => "all-add_processed_timestamp" }
    }
  }
}