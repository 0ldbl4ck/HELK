# HELK All filter conf file
# HELK build Stage: Alpha
# Author: Roberto Rodriguez (@Cyb3rWard0g), Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {
  if [message] {
    mutate {
      add_field => {
          "log_ingest_timestamp" => "%{@timestamp}"
          "z_etl_pipeline" => "all-filter-0098"
      }
      copy => {
          "message" => "z_original_message"
          "type" => "z_logstash_type"
      }
    }
    ruby {
      code => "event.set('z_ingest_processed_timestamp', Time.now());"
    }
  }
}