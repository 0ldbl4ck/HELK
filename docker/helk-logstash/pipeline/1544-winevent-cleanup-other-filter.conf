# HELK winevent-cleanup-other filter conf
# HELK build Stage: Alpha
# Author: Roberto Rodridguez (@Cyb3rWard0g), Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {
    if [event_id] {
        if [user_logon_guid] {
            mutate {
                add_field => { "z_logstash_pipeline" => "cleanup-user_logon_guid" }
                gsub => [ "user_logon_guid", "[{}]", "" ]
            }
        }
        if [provider_guid] {
            mutate {
                add_field => { "z_logstash_pipeline" => "cleanup-provider_guid" }
                gsub => [ "provider_guid", "[{}]", "" ]
            }
        }
        if [process_guid] {
            mutate {
                add_field => { "z_logstash_pipeline" => "cleanup-process_guid" }
                gsub => [ "process_guid", "[{}]", "" ]
            }
        }
        if [process_parent_guid] {
            mutate {
                add_field => { "z_logstash_pipeline" => "cleanup-process_parent_guid" }
                gsub => [ "process_parent_guid", "[{}]", "" ]
            }
        }
        if [process_target_guid] {
            mutate {
                add_field => { "z_logstash_pipeline" => "cleanup-process_target_guid" }
                gsub => [ "process_target_guid", "[{}]", "" ]
            }
        }
        if [message] {
            mutate {
                add_field => { "z_logstash_pipeline" => "cleanup-remove-message" }
                remove_field => [ "message" ]
            }
        }
        if [user_target_logon_guid] {
            mutate {
                add_field => { "z_logstash_pipeline" => "cleanup-user_target_logon_guid" }
                gsub => [ "user_target_logon_guid", "[{}]", "" ]
            }
        }
    }
}